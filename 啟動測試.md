# ✅ 修復完成 - 啟動指南

## 🎉 Gradio 6.0 兼容性問題已修復

已完成以下修復:
1. ✅ 移除不兼容的 `theme` 參數
2. ✅ 更新為 Gradio 6.0 的新消息格式
3. ✅ 消息格式從元組改為字典 (role/content)

---

## 🚀 立即開始使用

### 啟動 Web 聊天界面

```bash
python run_chat.py
```

然後在瀏覽器中打開顯示的網址（通常是 `http://localhost:7860`）

---

## 💬 使用範例

### 輸入範例 1: 單幣種分析
```
你: PI 可以投資嗎?
```

系統會:
1. 使用 LLM 解析查詢，識別出 "PI"
2. 標準化為 "PIUSDT"
3. 分析現貨市場 (1x 槓桿)
4. 分析合約市場 (5x 槓桿)
5. 返回投資建議

---

### 輸入範例 2: 多幣種比較
```
你: XRP, PI, ETH 哪些可以投資?
```

系統會:
1. 識別出 3 個幣種: XRP, PI, ETH
2. 分別分析每個幣種
3. 生成比較報告
4. 給出綜合建議

---

### 輸入範例 3: 自然語言
```
你: 比特幣現在適合進場嗎?
```

系統會:
1. 將 "比特幣" 轉換為 "BTC"
2. 標準化為 "BTCUSDT"
3. 進行完整分析
4. 給出進場建議

---

## 🔧 技術細節

### 消息格式 (Gradio 6.0)

**舊格式 (不再支持):**
```python
history = [
    ("用戶消息", "助手回應"),
    ("用戶消息2", "助手回應2")
]
```

**新格式 (已實現):**
```python
history = [
    {"role": "user", "content": "用戶消息"},
    {"role": "assistant", "content": "助手回應"},
    {"role": "user", "content": "用戶消息2"},
    {"role": "assistant", "content": "助手回應2"}
]
```

---

## 📊 分析流程

```
用戶輸入
    ↓
LLM 解析 (GPT-4o)
  ├─ 識別意圖
  ├─ 提取幣種代號
  └─ 確定動作類型
    ↓
符號標準化
  └─ 添加 USDT 後綴
    ↓
雙市場分析
  ├─ 現貨市場
  │   ├─ 技術分析
  │   ├─ 情緒分析
  │   ├─ 基本面分析
  │   ├─ 新聞分析
  │   ├─ 多空辯論
  │   ├─ 風險評估
  │   └─ 投資決策
  │
  └─ 合約市場
      ├─ 技術分析
      ├─ 情緒分析
      ├─ 基本面分析
      ├─ 新聞分析
      ├─ 多空辯論
      ├─ 風險評估
      └─ 投資決策
    ↓
生成摘要報告
    ↓
返回給用戶
```

---

## 🧪 測試功能

### 快速測試
```bash
# 測試 LLM 解析和基礎功能
python test_chat.py
```

### 命令行演示
```bash
# 在終端中直接對話
python demo_chat.py
```

---

## ⚠️ 注意事項

1. **API 密鑰**: 確保 `.env` 文件配置正確
   ```env
   OPENAI_API_KEY=你的密鑰
   BINANCE_API_KEY=你的密鑰
   BINANCE_API_SECRET=你的密鑰
   ```

2. **網絡連接**: 需要訪問:
   - OpenAI API (查詢解析和分析)
   - Binance API (市場數據)
   - CryptoPanic API (新聞數據)

3. **第一次分析**: 可能需要較長時間 (1-2 分鐘)
   - 包含數據獲取
   - LLM 多次調用
   - 多層決策流程

4. **幣種支持**: 僅支持 Binance 已上架的幣種

---

## 🐛 故障排除

### 問題: 找不到交易對
```
❌ 找不到交易對 PIUSDT
```

**可能原因:**
- PI 幣可能未在 Binance 上架
- 嘗試使用其他幣種如 BTC, ETH, XRP

**解決方案:**
```bash
# 先測試確定可用的幣種
python main.py --symbol BTCUSDT
python main.py --symbol ETHUSDT
```

### 問題: API 錯誤
```
❌ 分析時發生錯誤
```

**檢查清單:**
- [ ] `.env` 文件存在
- [ ] API 密鑰正確
- [ ] 網絡連接正常
- [ ] API 配額充足

---

## 📈 預期輸出範例

```markdown
## 📊 BTCUSDT 投資分析報告

**當前價格**: $43250.5000

### 🏪 現貨市場
**決策**: 買入
**理由**: 技術指標顯示超賣，RSI 低於 30，MACD 即將金叉...

### 📈 合約市場 (5x 槓桿)
**決策**: 觀望
**理由**: 雖然技術面看漲，但考慮到高槓桿風險...

**風險等級**: 中等

---
*分析時間: 2025-12-05 10:30:15*
```

---

## 🎯 下一步

1. **啟動服務**: `python run_chat.py`
2. **打開瀏覽器**: 訪問顯示的網址
3. **開始對話**: 輸入你的投資問題
4. **查看分析**: 等待系統完成分析

---

**祝你投資順利！** 🚀📈
