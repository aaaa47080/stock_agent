<solve>
è®ºå›å‘å¸–åé¡µé¢è·³è½¬é—®é¢˜ - æ”¹è¿›æ–¹æ¡ˆ
</solve>

<answer>
é—®é¢˜ï¼šè®ºå›å‘å¸–æˆåŠŸåé¡µé¢æ²¡æœ‰æ­£ç¡®è·³è½¬åˆ°è®ºå›é¦–é¡µ

å¯èƒ½åŸå› ï¼š
1. è·³è½¬ä»£ç å­˜åœ¨ç¼ºé™·
2. é”™è¯¯å¤„ç†ä¸å½“
3. æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜
4. JavaScriptæ‰§è¡Œç¯å¢ƒé—®é¢˜

è§£å†³æ–¹æ¡ˆ - æ”¹è¿›è·³è½¬é€»è¾‘ï¼š

// åœ¨ web/js/forum.js ä¸­æ”¹è¿›å‘å¸–æˆåŠŸåçš„å¤„ç†é€»è¾‘
try {
    await ForumAPI.createPost(postData);

    // æ¸…é™¤ç°æœ‰toast
    const container = document.getElementById('toast-container');
    if (container) container.innerHTML = '';
    
    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
    showToast('ğŸ‰ ç™¼å¸ƒæˆåŠŸï¼', 'success', 3000);
    
    // ç«‹å³ç¦ç”¨è¡¨å•æŒ‰é’®ä»¥é˜²æ­¢é‡å¤æäº¤
    if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="w-4 h-4 animate-spin" data-lucide="loader-2"></i> Redirecting...';
        if (window.lucide) lucide.createIcons();
    }
    
    // ä½¿ç”¨æ›´å¯é çš„è·³è½¬æ–¹å¼
    setTimeout(() => {
        try {
            // å°è¯•ä½¿ç”¨ window.location.href
            window.location.href = '/static/forum/index.html';
        } catch (redirectError) {
            console.error('Redirect failed:', redirectError);
            // å¦‚æœ href æ–¹å¼å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨ replace
            try {
                window.location.replace('/static/forum/index.html');
            } catch (replaceError) {
                console.error('Replace also failed:', replaceError);
                // å¦‚æœéƒ½å¤±è´¥ï¼Œæ˜¾ç¤ºæç¤ºè®©ç”¨æˆ·æ‰‹åŠ¨è·³è½¬
                alert('ç™¼æ–‡æˆåŠŸï¼æ­£åœ¨è·³è½‰é é¢...');
                // æœ€åå°è¯•ä½¿ç”¨ window.open ç„¶åå…³é—­å½“å‰çª—å£
                window.open('/static/forum/index.html', '_self');
            }
        }
    }, 2000); // å‡å°‘ç­‰å¾…æ—¶é—´

} catch (err) {
    showToast('ç™¼å¸ƒå¤±æ•—: ' + err.message, 'error');
    resetButton();
}
</answer>

<solve>
è®ºå›å‘å¸–æˆåŠŸä½†æ²¡æœ‰æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯æˆ–æ–‡ç« æœªå‡ºç° - æ”¹è¿›é”™è¯¯å¤„ç†
</solve>

<answer>
å¢å¼ºé”™è¯¯å¤„ç†å’Œåé¦ˆæœºåˆ¶ï¼š

// æ”¹è¿› ForumAPI.createPost å‡½æ•°çš„é”™è¯¯å¤„ç†
async createPost(data) {
    try {
        const res = await fetch('/api/forum/posts', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        
        if (!res.ok) {
            let errorMsg = 'Failed to create post';
            try {
                const err = await res.json();
                if (typeof err.detail === 'string') {
                    errorMsg = err.detail;
                } else if (Array.isArray(err.detail)) {
                    errorMsg = err.detail.map(e => `${e.loc.join('.')}: ${e.msg}`).join('\n');
                } else if (err.message) {
                    errorMsg = err.message;
                } else {
                    errorMsg = JSON.stringify(err);
                }
            } catch (parseError) {
                console.error('Error parsing response:', parseError);
                errorMsg = `Status ${res.status}: ${res.statusText}`;
            }
            throw new Error(errorMsg);
        }
        
        const result = await res.json();
        console.log('Post creation successful:', result); // æ·»åŠ è°ƒè¯•æ—¥å¿—
        return result;
    } catch (error) {
        console.error('Post creation error:', error); // æ·»åŠ é”™è¯¯æ—¥å¿—
        throw error;
    }
},

// æ”¹è¿›æäº¤å¤„ç†å‡½æ•°
// åœ¨æäº¤å¤„ç†ä¸­æ·»åŠ æ›´å¤šè°ƒè¯•ä¿¡æ¯
console.log('Starting post creation...');
const result = await ForumAPI.createPost(postData);
console.log('Post creation API call succeeded:', result);

// ç»§ç»­åŸæ¥çš„è·³è½¬é€»è¾‘...
</answer>