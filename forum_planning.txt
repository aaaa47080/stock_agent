================================================================================
                        社群討論區功能規劃書
                        Pi Crypto Insight Forum
================================================================================

最後更新：2026-01-19

================================================================================
一、功能概述
================================================================================

建立一個類似 PTT 形式的社群討論區，結合 Pi Network 支付機制。
用戶可以發表文章、回覆討論、打賞作者，並透過標籤系統組織內容。

核心特色：
- Pi Network 原生支付整合
- 看板分類系統
- 標籤聚合功能（#BTC #ETH）
- 會員分級制度
- 打賞機制

================================================================================
二、會員機制
================================================================================

┌──────────────┬──────────────┬──────────────┬──────────────┐
│     功能     │     訪客     │   免費會員   │   PRO 會員   │
├──────────────┼──────────────┼──────────────┼──────────────┤
│ 瀏覽文章     │      ✅      │      ✅      │      ✅      │
│ 註冊/登入    │      -       │      ✅      │      ✅      │
│ 回覆/推/噓   │      ❌      │      ✅      │      ✅      │
│ 發表文章     │      ❌      │  付費 1 Pi   │   ✅ 免費    │
│ 打賞他人     │      ❌      │      ✅      │      ✅      │
│ 添加好友     │      ❌      │      ❌      │      ✅      │
│ 私訊功能     │      ❌      │      ❌      │      ✅      │
│ 長期記憶     │      ❌      │      ❌      │      ✅      │
│ 每日回覆上限 │      -       │    20 則     │    無限      │
└──────────────┴──────────────┴──────────────┴──────────────┘

PRO 會員訂閱費用：待定（建議 10-30 Pi/月）

================================================================================
三、看板系統
================================================================================

目前規劃看板：
┌────────────────┬────────────────┬────────────────┐
│     看板名稱   │      Slug      │      狀態      │
├────────────────┼────────────────┼────────────────┤
│   加密貨幣     │     crypto     │     啟用       │
│   美股         │    us_stock    │     未來       │
│   台股         │    tw_stock    │     未來       │
│   綜合討論     │    general     │     未來       │
└────────────────┴────────────────┴────────────────┘

發文流程：
1. 用戶點擊「發文」
2. 選擇要發文的看板（目前僅加密貨幣）
3. 進入發文頁面
4. 填寫表單並發布

================================================================================
四、文章分類
================================================================================

┌────────────────┬────────────────┬────────────────┐
│     分類代碼   │     顯示名稱   │      說明      │
├────────────────┼────────────────┼────────────────┤
│   analysis     │    [分析]      │ 技術面/基本面  │
│   question     │    [請益]      │ 提問求助       │
│   tutorial     │    [教學]      │ 教學說明文章   │
│   news         │    [新聞]      │ 新聞整理分享   │
│   chat         │    [閒聊]      │ 一般討論       │
│   insight      │    [心得]      │ 交易心得分享   │
└────────────────┴────────────────┴────────────────┘

================================================================================
五、發文功能
================================================================================

發文表單欄位：
┌────────────────┬────────────────┬────────────────┬────────────────┐
│     欄位名稱   │     類型       │     必填       │      說明      │
├────────────────┼────────────────┼────────────────┼────────────────┤
│   看板         │   預先選定     │      ✅        │ 發文前選擇     │
│   分類         │   下拉選單     │      ✅        │ 上述六種分類   │
│   標題         │   文字輸入     │      ✅        │ 限 50 字       │
│   內容         │   多行文字     │      ✅        │ 支援基本格式   │
│   標籤         │   文字輸入     │      ❌        │ #BTC #ETH      │
└────────────────┴────────────────┴────────────────┴────────────────┘

發文頁面 UI 示意：
┌─────────────────────────────────────────────────────┐
│  📝 發表文章                                        │
│  看板：加密貨幣                          需付 1 Pi  │
├─────────────────────────────────────────────────────┤
│                                                     │
│  分類                                               │
│  ┌─────────────┐                                    │
│  │ 分析      ▼ │                                    │
│  └─────────────┘                                    │
│                                                     │
│  標題                                               │
│  ┌─────────────────────────────────────────────┐   │
│  │                                             │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  內容                                               │
│  ┌─────────────────────────────────────────────┐   │
│  │ B  I  U  📷  🔗                             │   │
│  ├─────────────────────────────────────────────┤   │
│  │                                             │   │
│  │                                             │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  標籤（選填）                                       │
│  ┌─────────────────────────────────────────────┐   │
│  │ #BTC #ETH                                   │   │
│  └─────────────────────────────────────────────┘   │
│  💡 熱門：#BTC  #ETH  #SOL  #DOGE                   │
│                                                     │
│           ┌─────────────┐  ┌─────────────┐         │
│           │    取消     │  │   發布 💰   │         │
│           └─────────────┘  └─────────────┘         │
└─────────────────────────────────────────────────────┘

================================================================================
六、文章列表頁
================================================================================

列表頁 UI 示意：
┌────────────────────────────────────────────────────────┐
│  加密貨幣看板                              [發表文章]  │
├────────────────────────────────────────────────────────┤
│  [全部] [分析] [請益] [教學] [新聞] [閒聊] [心得]      │
│  熱門標籤：#BTC  #ETH  #SOL  #DOGE                     │
├────────────────────────────────────────────────────────┤
│  推/噓   分類     標題                    作者   日期  │
├────────────────────────────────────────────────────────┤
│  🔥52   [分析]   BTC 十萬後走勢分析       user1  01/19 │
│    18   [請益]   ETH 現在可以進場嗎？     user2  01/19 │
│  🔥34   [教學]   新手必看：K線基礎教學    user3  01/18 │
│     6   [新聞]   Fed 利率決議整理         user4  01/18 │
│    12   [心得]   今天 SOL 做多心得        user5  01/18 │
└────────────────────────────────────────────────────────┘

說明：
- 推/噓 顯示淨推數（推數 - 噓數）
- 🔥 表示熱門文章（淨推數 > 30）
- 點擊標題進入文章詳情頁
- 可依分類篩選
- 可點擊標籤查看相關文章

================================================================================
七、文章詳情頁
================================================================================

詳情頁 UI 示意：
┌────────────────────────────────────────────────────────┐
│  ← 返回列表                                            │
├────────────────────────────────────────────────────────┤
│  [分析] BTC 十萬後的走勢分析                           │
│  作者：user1  時間：2026/01/19 14:32                   │
│  標籤：#BTC #ETH                                       │
├────────────────────────────────────────────────────────┤
│                                                        │
│  （文章內容）                                          │
│                                                        │
│  根據技術分析，BTC 突破十萬後...                       │
│  1. 短期支撐位在 95,000                                │
│  2. 壓力位在 110,000                                   │
│  3. 建議操作策略...                                    │
│                                                        │
├────────────────────────────────────────────────────────┤
│  👍 推 (52)   👎 噓 (3)   💬 回覆   🎁 打賞 1Pi        │
├────────────────────────────────────────────────────────┤
│  回覆區                                                │
├────────────────────────────────────────────────────────┤
│  👍 user5: 分析得很詳細，感謝分享           01/19 15:01│
│  👍 user6: 同意這個觀點                     01/19 15:23│
│  👎 user7: 我覺得太樂觀了                   01/19 15:45│
│  💬 user8: 請問週期是看多長？               01/19 16:02│
│     └─ user1: 我是看日線級別               01/19 16:15│
│  👍 user9: 已打賞支持                       01/19 16:30│
└────────────────────────────────────────────────────────┘

================================================================================
八、回覆機制
================================================================================

回覆類型：
┌────────────────┬────────────────┬────────────────┐
│     類型       │     顯示       │      說明      │
├────────────────┼────────────────┼────────────────┤
│   push         │      👍        │ 推（支持）     │
│   boo          │      👎        │ 噓（反對）     │
│   comment      │      💬        │ 一般回覆       │
└────────────────┴────────────────┴────────────────┘

回覆規則：
- 需要登入才能回覆
- 免費會員每日上限 20 則回覆
- PRO 會員無限制
- 回覆可附帶短評（限 100 字）
- 噓文過多（淨噓數 > 10）自動摺疊

================================================================================
九、打賞機制
================================================================================

打賞流程：
1. 用戶點擊文章的「打賞」按鈕
2. 確認支付 1 Pi
3. Pi 從打賞者錢包轉移到作者錢包
4. 記錄交易哈希
5. 文章顯示累計打賞金額

打賞規則：
- 每次打賞固定 1 Pi
- 可對同一篇文章多次打賞
- 作者可在個人頁面查看收到的打賞總額

交易哈希（tx_hash）可見性：
┌────────────────────┬────────────────────────────────────────────────┐
│       角色         │                  可見內容                      │
├────────────────────┼────────────────────────────────────────────────┤
│   發文者本人       │ 自己發文付款的 tx_hash                         │
│   打賞者本人       │ 自己打賞出去的 tx_hash                         │
│   被打賞者（作者） │ 收到的每筆打賞 tx_hash                         │
│   其他人           │ 只能看到「本文累計收到 X Pi」，無法看到 tx_hash│
└────────────────────┴────────────────────────────────────────────────┘

說明：
- 交易哈希是區塊鏈上的收據編號，用於證明交易確實發生
- 屬於私人資訊，僅當事人可見
- 可用於爭議處理、帳務核對

UI 示例：

其他人看到的：
┌────────────────────────────────────────┐
│  🎁 本文累計打賞：5 Pi                 │
└────────────────────────────────────────┘

作者在個人後台看到的：
┌────────────────────────────────────────────────────────────────┐
│  打賞記錄                                                      │
├──────────┬────────┬─────────────────────────────┬──────────────┤
│   來自   │  金額  │        交易哈希             │     時間     │
├──────────┼────────┼─────────────────────────────┼──────────────┤
│  user5   │  1 Pi  │  7f3a8b2c...（點擊複製）    │  01/19 15:30 │
│  user6   │  1 Pi  │  9d4e6f1a...（點擊複製）    │  01/19 16:45 │
└──────────┴────────┴─────────────────────────────┴──────────────┘

打賞者在個人後台看到的：
┌────────────────────────────────────────────────────────────────┐
│  我的打賞記錄                                                  │
├──────────┬────────┬─────────────────────────────┬──────────────┤
│   對象   │  金額  │        交易哈希             │     時間     │
├──────────┼────────┼─────────────────────────────┼──────────────┤
│  user1   │  1 Pi  │  7f3a8b2c...（點擊複製）    │  01/19 15:30 │
│  user3   │  1 Pi  │  a2b3c4d5...（點擊複製）    │  01/18 12:00 │
└──────────┴────────┴─────────────────────────────┴──────────────┘

================================================================================
十、標籤系統
================================================================================

標籤規則：
- 格式：#符號 + 標籤名稱（如 #BTC #ETH）
- 一篇文章最多 5 個標籤
- 標籤自動建立，無需預先定義
- 點擊標籤可查看所有相關文章

熱門標籤：
- 依據近期文章數量自動計算
- 顯示在發文頁和列表頁
- 方便用戶快速瀏覽熱門話題

================================================================================
十一、資料庫設計
================================================================================

-- 看板表
CREATE TABLE boards (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    name            TEXT NOT NULL,              -- "加密貨幣"
    slug            TEXT NOT NULL UNIQUE,       -- "crypto"
    description     TEXT,                       -- 看板描述
    post_count      INTEGER DEFAULT 0,          -- 文章數
    is_active       BOOLEAN DEFAULT 1,          -- 是否啟用
    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 文章表
CREATE TABLE posts (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    board_id        INTEGER NOT NULL,           -- 所屬看板
    user_id         INTEGER NOT NULL,           -- 作者
    category        TEXT NOT NULL,              -- analysis/question/tutorial/news/chat/insight
    title           TEXT NOT NULL,              -- 標題（限50字）
    content         TEXT NOT NULL,              -- 內容
    tags            TEXT,                       -- JSON: ["BTC", "ETH"]

    -- 統計數據
    push_count      INTEGER DEFAULT 0,          -- 推數
    boo_count       INTEGER DEFAULT 0,          -- 噓數
    comment_count   INTEGER DEFAULT 0,          -- 回覆數
    tips_total      REAL DEFAULT 0,             -- 累計打賞 Pi
    view_count      INTEGER DEFAULT 0,          -- 瀏覽數

    -- 付費狀態
    payment_tx_hash TEXT,                       -- Pi 支付交易哈希

    -- 狀態
    is_pinned       BOOLEAN DEFAULT 0,          -- 是否置頂
    is_hidden       BOOLEAN DEFAULT 0,          -- 是否隱藏

    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (board_id) REFERENCES boards(id),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- 回覆表
CREATE TABLE comments (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    post_id         INTEGER NOT NULL,           -- 所屬文章
    user_id         INTEGER NOT NULL,           -- 回覆者
    parent_id       INTEGER,                    -- 父回覆（用於巢狀回覆）
    type            TEXT NOT NULL,              -- push/boo/comment
    content         TEXT,                       -- 回覆內容（限100字）

    is_hidden       BOOLEAN DEFAULT 0,          -- 是否隱藏

    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (post_id) REFERENCES posts(id),
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (parent_id) REFERENCES comments(id)
);

-- 打賞記錄表
CREATE TABLE tips (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    post_id         INTEGER NOT NULL,           -- 打賞的文章
    from_user_id    INTEGER NOT NULL,           -- 打賞者
    to_user_id      INTEGER NOT NULL,           -- 收款者（文章作者）
    amount          REAL NOT NULL DEFAULT 1,    -- 金額（固定 1 Pi）
    tx_hash         TEXT NOT NULL,              -- Pi 區塊鏈交易哈希

    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (post_id) REFERENCES posts(id),
    FOREIGN KEY (from_user_id) REFERENCES users(id),
    FOREIGN KEY (to_user_id) REFERENCES users(id)
);

-- 標籤統計表
CREATE TABLE tags (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    name            TEXT NOT NULL UNIQUE,       -- "BTC"
    post_count      INTEGER DEFAULT 0,          -- 使用此標籤的文章數
    last_used_at    TIMESTAMP,                  -- 最後使用時間

    created_at      TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 文章標籤關聯表
CREATE TABLE post_tags (
    post_id         INTEGER NOT NULL,
    tag_id          INTEGER NOT NULL,

    PRIMARY KEY (post_id, tag_id),
    FOREIGN KEY (post_id) REFERENCES posts(id),
    FOREIGN KEY (tag_id) REFERENCES tags(id)
);

-- 用戶每日回覆計數表
CREATE TABLE user_daily_comments (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id         INTEGER NOT NULL,
    date            DATE NOT NULL,              -- 日期
    comment_count   INTEGER DEFAULT 0,          -- 當日回覆數

    UNIQUE (user_id, date),
    FOREIGN KEY (user_id) REFERENCES users(id)
);

================================================================================
十二、API 端點規劃
================================================================================

看板相關：
┌────────────────────────────────────┬────────────────┬────────────────┐
│            端點                    │     方法       │      說明      │
├────────────────────────────────────┼────────────────┼────────────────┤
│ /api/forum/boards                  │     GET        │ 取得看板列表   │
│ /api/forum/boards/{slug}           │     GET        │ 取得看板詳情   │
└────────────────────────────────────┴────────────────┴────────────────┘

文章相關：
┌────────────────────────────────────┬────────────────┬────────────────┐
│            端點                    │     方法       │      說明      │
├────────────────────────────────────┼────────────────┼────────────────┤
│ /api/forum/posts                   │     GET        │ 取得文章列表   │
│ /api/forum/posts                   │     POST       │ 發表新文章     │
│ /api/forum/posts/{id}              │     GET        │ 取得文章詳情   │
│ /api/forum/posts/{id}              │     PUT        │ 編輯文章       │
│ /api/forum/posts/{id}              │     DELETE     │ 刪除文章       │
└────────────────────────────────────┴────────────────┴────────────────┘

回覆相關：
┌────────────────────────────────────┬────────────────┬────────────────┐
│            端點                    │     方法       │      說明      │
├────────────────────────────────────┼────────────────┼────────────────┤
│ /api/forum/posts/{id}/comments     │     GET        │ 取得回覆列表   │
│ /api/forum/posts/{id}/comments     │     POST       │ 新增回覆       │
│ /api/forum/posts/{id}/push         │     POST       │ 推文           │
│ /api/forum/posts/{id}/boo          │     POST       │ 噓文           │
└────────────────────────────────────┴────────────────┴────────────────┘

打賞相關：
┌────────────────────────────────────┬────────────────┬────────────────┐
│            端點                    │     方法       │      說明      │
├────────────────────────────────────┼────────────────┼────────────────┤
│ /api/forum/posts/{id}/tip          │     POST       │ 打賞文章       │
│ /api/forum/tips/history            │     GET        │ 打賞記錄       │
└────────────────────────────────────┴────────────────┴────────────────┘

標籤相關：
┌────────────────────────────────────┬────────────────┬────────────────┐
│            端點                    │     方法       │      說明      │
├────────────────────────────────────┼────────────────┼────────────────┤
│ /api/forum/tags                    │     GET        │ 取得標籤列表   │
│ /api/forum/tags/{name}/posts       │     GET        │ 取得標籤文章   │
│ /api/forum/tags/trending           │     GET        │ 取得熱門標籤   │
└────────────────────────────────────┴────────────────┴────────────────┘

================================================================================
十三、Pi Network 支付整合
================================================================================

發文支付流程：
┌─────────────────────────────────────────────────────────────────────┐
│  1. 用戶點擊「發布」按鈕                                            │
│                     ↓                                               │
│  2. 前端檢查用戶是否為 PRO 會員                                     │
│        ├─ 是 PRO 會員 → 直接發布（跳到步驟 6）                      │
│        └─ 不是 PRO 會員 → 繼續步驟 3                                │
│                     ↓                                               │
│  3. 前端呼叫 Pi.createPayment({ amount: 1, memo: "發文費用" })      │
│                     ↓                                               │
│  4. 用戶在 Pi App 確認支付                                          │
│                     ↓                                               │
│  5. 後端接收 Pi 支付回調，驗證交易                                  │
│                     ↓                                               │
│  6. 後端儲存文章，記錄 tx_hash                                      │
│                     ↓                                               │
│  7. 返回成功，前端跳轉到文章頁                                      │
└─────────────────────────────────────────────────────────────────────┘

打賞支付流程：
┌─────────────────────────────────────────────────────────────────────┐
│  1. 用戶點擊「打賞」按鈕                                            │
│                     ↓                                               │
│  2. 前端呼叫 Pi.createPayment({                                     │
│         amount: 1,                                                  │
│         memo: "打賞文章 #{post_id}",                                │
│         recipient: 作者的 Pi UID                                    │
│     })                                                              │
│                     ↓                                               │
│  3. 用戶在 Pi App 確認支付                                          │
│                     ↓                                               │
│  4. Pi 直接從用戶錢包轉到作者錢包（P2P）                            │
│                     ↓                                               │
│  5. 後端接收回調，記錄打賞記錄                                      │
│                     ↓                                               │
│  6. 更新文章的 tips_total                                           │
└─────────────────────────────────────────────────────────────────────┘

================================================================================
十四、防濫用機制
================================================================================

┌────────────────────┬────────────────────────────────────────────────┐
│       機制         │                    說明                        │
├────────────────────┼────────────────────────────────────────────────┤
│   登入門檻         │ 回覆需登入，擋掉匿名機器人                     │
│   每日回覆上限     │ 免費會員每日 20 則，防止洗版                   │
│   噓文摺疊         │ 淨噓數 > 10 自動摺疊，社群自治                 │
│   檢舉機制         │ 用戶可檢舉違規內容                             │
│   發文付費         │ 1 Pi 門檻過濾垃圾文                            │
│   冷卻時間         │ 同一用戶對同一文章推/噓間隔 1 分鐘             │
└────────────────────┴────────────────────────────────────────────────┘

================================================================================
十五、未來擴充規劃
================================================================================

Phase 1（現階段）：
- [x] 加密貨幣看板
- [x] 基本發文/回覆功能
- [x] 標籤系統
- [x] Pi 支付整合（發文付費、打賞）
- [x] 會員機制

Phase 2（之後）：
- [ ] 新增美股、台股看板
- [ ] 好友系統
- [ ] 私訊功能
- [ ] 作者信譽系統（準確率統計）
- [ ] 文章內嵌即時行情卡片

Phase 3（更遠）：
- [ ] AI 分析引用功能
- [ ] 追蹤作者功能
- [ ] 個人主頁
- [ ] 成就系統
- [ ] API 代理服務（用 Pi 購買 LLM 額度）

================================================================================
十六、個人後台
================================================================================

說明：
- 每個用戶登入後可進入個人後台
- 後端根據 user_id 識別當前用戶，只查詢該用戶相關的記錄
- 交易哈希等敏感資訊僅當事人可見

個人後台頁面結構：
┌────────────────────────────────────────────────────────────────┐
│  👤 我的帳戶                                                   │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  📝 我的文章                                                   │
│  ├── 已發表的文章列表                                          │
│  ├── 每篇文章的統計（推/噓/回覆/打賞）                         │
│  └── 編輯/刪除功能                                             │
│                                                                │
│  💰 我的交易記錄                                               │
│  ├── 發文付款記錄（我付出的）                                  │
│  ├── 送出的打賞（我打賞別人的）                                │
│  └── 收到的打賞（別人打賞我的）                                │
│                                                                │
│  💬 我的回覆                                                   │
│  └── 我在各文章的回覆記錄                                      │
│                                                                │
│  ⚙️ 帳戶設定                                                   │
│  ├── 個人資料編輯                                              │
│  └── PRO 會員訂閱管理                                          │
│                                                                │
└────────────────────────────────────────────────────────────────┘

交易記錄頁面 UI：
┌────────────────────────────────────────────────────────────────┐
│  💰 我的交易記錄                                               │
├────────────────────────────────────────────────────────────────┤
│  [發文付款] [送出的打賞] [收到的打賞]    ← 分頁切換            │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  📤 送出的打賞                                                 │
│  ┌──────────┬──────────┬────────┬─────────────────┬──────────┐│
│  │  文章    │  作者    │  金額  │    交易哈希     │   時間   ││
│  ├──────────┼──────────┼────────┼─────────────────┼──────────┤│
│  │ BTC分析  │  user1   │  1 Pi  │  7f3a...(複製) │ 01/19    ││
│  │ ETH教學  │  user3   │  1 Pi  │  a2b3...(複製) │ 01/18    ││
│  └──────────┴──────────┴────────┴─────────────────┴──────────┘│
│                                                                │
│  📥 收到的打賞                                                 │
│  ┌──────────┬──────────┬────────┬─────────────────┬──────────┐│
│  │  文章    │  來自    │  金額  │    交易哈希     │   時間   ││
│  ├──────────┼──────────┼────────┼─────────────────┼──────────┤│
│  │ 我的文章1│  user5   │  1 Pi  │  9d4e...(複製) │ 01/19    ││
│  │ 我的文章1│  user6   │  1 Pi  │  c3d4...(複製) │ 01/19    ││
│  │ 我的文章2│  user7   │  1 Pi  │  e5f6...(複製) │ 01/18    ││
│  └──────────┴──────────┴────────┴─────────────────┴──────────┘│
│                                                                │
│  累計收到：3 Pi                                                │
│                                                                │
└────────────────────────────────────────────────────────────────┘

資料庫查詢邏輯：
┌────────────────────────────────────────────────────────────────┐
│  -- 查詢「我發文付的款」                                       │
│  SELECT payment_tx_hash, title, created_at                     │
│  FROM posts                                                    │
│  WHERE user_id = {當前用戶ID} AND payment_tx_hash IS NOT NULL  │
│                                                                │
│  -- 查詢「我送出的打賞」                                       │
│  SELECT * FROM tips                                            │
│  WHERE from_user_id = {當前用戶ID}                             │
│                                                                │
│  -- 查詢「我收到的打賞」                                       │
│  SELECT * FROM tips                                            │
│  WHERE to_user_id = {當前用戶ID}                               │
└────────────────────────────────────────────────────────────────┘

API 端點：
┌────────────────────────────────────┬────────────────┬─────────────────────┐
│            端點                    │     方法       │        說明         │
├────────────────────────────────────┼────────────────┼─────────────────────┤
│ /api/forum/me/posts                │     GET        │ 取得我的文章列表    │
│ /api/forum/me/comments             │     GET        │ 取得我的回覆列表    │
│ /api/forum/me/tips/sent            │     GET        │ 取得送出的打賞記錄  │
│ /api/forum/me/tips/received        │     GET        │ 取得收到的打賞記錄  │
│ /api/forum/me/payments             │     GET        │ 取得發文付款記錄    │
└────────────────────────────────────┴────────────────┴─────────────────────┘

================================================================================
十七、技術實作備註
================================================================================

前端：
- 在現有 web/ 目錄下新增 forum/ 相關頁面
- 使用現有的 auth.js 處理登入狀態
- Pi SDK 已整合，可直接使用

後端：
- 在 api/routers/ 下新增 forum.py
- 使用現有的 database.py 擴充資料表
- Pi 支付回調需新增 webhook 端點

資料庫：
- 沿用現有的 SQLite 資料庫
- 新增上述資料表
- 建立適當索引優化查詢

================================================================================
                              文件結束
================================================================================
